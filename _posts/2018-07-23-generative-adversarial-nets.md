---
layout: post
title: 딥러닝 이미지 생성 모델의 새 트렌드, GAN
category: Image Generation
---

## Meta Information
* 제목 : Generative Adversarial Nets
* 2014.06 : arXiv submit
* 2014.12  : NIPS

## 연구 동기
사람들에게 큰 임팩트를 준 대부분의 딥러닝 모델은 판별 모델(discriminative model)입니다.
수천 장 개와 고양이 이미지 데이터가 주어졌을 때 이를 올바르게 구분해 주는 모델, 고차원 입력 데이터를 특정 클래스 레이블로 매핑하는 모델을 판별 모델이라고 합니다.
그러나 판별 모델이 높은 성능을 보이는 데 비해 상대적으로 이미지 자체를 생성하는 모델은 성능이 좋지 않았습니다.
생성 모델이 좋은 성능을 내려면 데이터 분포를 추정해야 하는데, 최대우도추정과 같은 확률적 계산을 근사하는 것이 쉽지 않았기 때문입니다.<br>
그래서 이 논문은 생성 모델과 판별 모델을 서로 싸우게 하여 서로 성능을 높이는 방법론을 제안했습니다.
생성 모델은 이미지를 생성해내고 판별 모델은 그 이미지를 구분하는 방식입니다.
비유를 통해 좀 더 직관적으로 이해를 해보면 생성 모델은 위조지폐범, 판별 모델은 경찰과 같은 역할을 합니다.
위조지폐범은 경찰을 속이도록 점점 위조지폐를 정교하게 만들고 경찰은 그 위조지폐를 더 잘 구분하는 법을 배웁니다.
서로 자신의 역할을 점점 더 잘하다보면 어느 시점에서 위조지폐가 진짜와 구분되지 않은 순간이 오게 됩니다.
이 프레임워크의 목적은 진짜와 가짜가 구분이 되지 않는 시점까지 생성 모델을 학습시켜 진짜같은 이미지를 생성해내는 것입니다.
이러한 프레임워크를 **‘adversarial nets’**이라고 합니다.

## 모델 구조 & 학습 방법
GAN의 모델 구조는 매우 심플합니다.
이미지 생성 모델 G가 있고 샘플이 실제 이미지인지 아니면 G가 만든 것인지 구분하는 판별 모델 D가 있는 구조입니다.
구조 자체는 심플하나, GAN을 이해함에 있어서 중요한 포인트는 학습이 이루어지는 방식을 이해하는 것입니다.
먼저 GAN의 목적함수는 다음과 같습니다.

$$\underset{G}{min} \underset{D}{max}V(D,G)=E_{x \sim p_{data}(x)}[logD(x)]+E_{z \sim p_{z}(z)}[log(1-D(G(z)))]$$

먼저 D는 실제와 가짜 이미지를 확률값으로 구분합니다.
실제 이미지인 경우는 1에 가까운 확률값을 할당하고 가짜 이미지는 0에 가까운 확률값을 할당해야 합니다.
즉, 목적함수의 $E_{x \sim p_{data}(x)}[logD(x)]$와 $E_{z \sim p_{z}(z)}[log(1-D(G(z)))]$를 최대화 시켜야 합니다.
반대로 G는 임의의 분포로부터 z를 받아 이미지를 생성하여 $E_{z \sim p_{z}(z)}[log(1-D(G(z)))]$를 최소화시키는 것을 목적으로 합니다.
