---
layout: post
title: 베이즈 추정의 element, Prior & Posterior probability
category: Non-Category
---

이번 글에서는 베이즈 추정의 과정과 사전확률(prior probability), 그리고 사후확률(posterior)에 대해서 살펴보겠습니다.
이 글은 '베이즈통계학 입문' 서적을 정리한 내용으로 잘못된 해석이나 이해가 포함될 수 있으니 첨언과 조언은 언제나 환영합니다.
  
## 베이즈 추정

상점에서 물건을 파는 점원에 입장에서 고객이 물건을 사러 온 사람인지, 아니면 구경만 하러 온 사람인지 구분하는 것은 중요합니다.
경험으로 어느정도 직관적으로 파악할 수 있겠지만 이 '직감적인 판단'을 수치화 할 수 있다면 이것도 꽤 의의있는 일이라고 할 수 있습니다.
베이즈 추정은 이 때 유용하게 사용될 수 있습니다.

베이즈 통계학도 통계학의 범주에 속하기에 당연히 데이터를 기반으로 문제에 접근합니다.
먼저 어떤 고객이 상점으로 들어온 상황을 가정하겠습니다.
우리는 아직 이 고객이 물건을 사러 온 사람인지 구경만 온 사람인지 알 수 없습니다.
그러나 해당 고객이 두 범주 중 하나에 속해 있음은 분명합니다.
고객이 특정 범주에 속할 확률, 두 범주에 대한 비율이 몇인지 수치를 배정하는 것이 사전확률(prior probability)입니다.

그러나 상점을 방문하는 전체 고객의 사전확률을 알 수 없을 때, 우리는 주관적으로 사전확률을 설정해야 합니다.
고객이 물건을 사러 왔다는 근거는 없지만 구경만 하러 왔다는 근거도 없기 때문에 양쪽 범주에 속할 확률이 일단 대등하다고 생각하여 $\frac{1}{범주 수}$의 확률을 사전확률로 설정할 수 있습니다. 

![](/public/img/prior_posterior_figure1.JPG "Figure1 of Prior & Posterior probability")

그리고 데이터에 기반하여 쇼핑하러 온 고객이 말을 걸 확률, 쇼핑하러 온 고객이 말을 걸지 않을 확률, 구경하러 온 고객이 말을 걸 확률, 구경하러 온 고객이 말을 걸지 않을 확률을 얻을 수 있습니다.
이것은 조건부 확률로 이 예제에서 범주를 한정할 경우 각 행동의 확률로 나타납니다.
범주가 행동의 원인이라 하면 원인을 알 때 결과의 확률이라고 해석할 수 있습니다.
우선 예시로 다음과 같이 확률을 설정하겠습니다.

$$
\begin{align*}
P(말을 걸 확률|쇼핑하러 온 고객) = 0.9 \\
P(말을 걸지 않을 확률|쇼핑하러 온 고객) = 0.1 \\
P(말을 걸 확률|구경하러 온 고객) = 0.3 \\
P(말을 걸지 않을 확률|구경하러 온 고객) = 0.7
\end{align*}
$$

이 때 각 유형의 확률은 다음과 같이 그림으로 나타낼 수 있습니다.   

![](/public/img/prior_posterior_figure2.JPG "Figure2 of Prior & Posterior probability")

자, 여기까지 왔으면 추정을 위한 모든 데이터 기반의 준비가 끝났습니다.
이제 새로운 고객이 상점을 방문했다고 가정하겠습니다.
그리고 이 고객이 점원에게 말을 걸었습니다!
이 때, 이 고객이 쇼핑하러 온 고객인지 구경하러 온 고객인지 확률은 어떻게 변할까요?

우리는 고객의 유형과 말을 거는 행동에 따른 4가지 A~D 확률을 가지고 있습니다.
이 중 말을 걸었다는 행동으로부터 A와 B만 유효한 영역으로 남게 됩니다.
즉, 말을 건 행동으로부터 쇼핑하러 온 고객일 확률은 $\frac{0.45}{0.45+0.05}$이며 구경하러 온 고객일 확률은 $\frac{0.05}{0.45+0.05}$가 됩니다.
쇼핑하러 온 고객 : 구경하러 온 고객의 비율이 9:1로 새롭게 만들어지는 이것이 사후확률(posterior probability)입니다.
말을 걸었다는 행동(결과)로부터 범주(원인)를 예측하는 확률이라고도 할 수 있습니다.
이렇게 사전활률이 사후확률로 갱신되는 전 과정이 베이즈 추정 과정입니다.

