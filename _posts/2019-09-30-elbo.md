---
layout: post
title: ELBO(Evidence LowerBOund)
category: Non-Category
---

## Jensen's Inequality를 활용한 ELBO 구하기

함수 p(x)는 x에 대한 확률이며 p(z)라는 latent distribution에서 샘플링 된 z로부터 추정된 x의 분포이기도 하다.

$$ log(p(x)) = log(\int\limits p(x|z)p(z))dz \geq \int\limits log(p(x|z))p(z)dz $$

Jensen's inequality를 사용하여 위와 같은 수식을 얻을 수 있는데 이는 다음과 같은 수식으로 변경이 가능하다.

$$ log(p(x)) = log(\int\limits p(x|z)\frac{p(z)}{q_{\phi}(z|x)}q_{\phi}(z|x)dz) \geq \int\limits log(p(x|z)\frac{p(z)}{q_{\phi}(z|x)})q_{\phi}(z|x)dz $$

$ q_{\phi}(z|x) $라는 함수가 추가로 도입된 것이다.
즉, 이는 수식을 정리하면 다음과 같이 나눠질 수 있다.

$$ log(p(x)) \geq \int\limits log(p(x|z))q_{\phi}(z|x)dz - \int\limits log(\frac{q_{\phi}(z|x)}{p(z)})q_{\phi}(z|x)dz $$

그리고 이 수식은 기대값 수식과 KL divergence 수식으로 변경할 수 있다.

$$ \int\limits log(p(x|z))q_{\phi}(z|x)dz - \int\limits log(\frac{q_{\phi}(z|x)}{p(z)})q_{\phi}(z|x)dz = E_{q_{\phi}(z|x)}[log(p(x|z))] - KL(q_{\phi}(z|x) || p(z)) $$

이 수식이 ELBO(\phi)다.
구해진 수식이 항상 log(p(x))보다 작거나 같기 때문에 lowerbound라고 부른다.


